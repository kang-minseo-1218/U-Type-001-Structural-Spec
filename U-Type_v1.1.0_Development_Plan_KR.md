# U-Type-001 v1.1.0 개발 방향 문서

## 1. 명령 예외 처리 구조

* **혼합 명령 처리**: 감정억제 + 병렬실행 명령 등 다중 명령어 병합 시 처리 우선순위 명시 필요  
  * 예: `설계자 모드 + 복구자 모드` → 설계자 우선 적용 후 복구 트리거 보조 실행  
  * ✅ [보완] 모드 우선순위 테이블 삽입 예정 (`설계자 > 통제자 > 감정억제 > 복구자` 등)

* **비정형 명령 예외 처리**: 구조화되지 않은 자유 명령 입력에 대한 fallback 체계 필요  
  * 예: “나 지금 화나” → `감정 억제 모드` 자동 감지 + `상태 진단 모드` 병행 실행  
  * ✅ [보완] 자연어 입력에 대해 `의도 감지 인지자` 우선 호출 + fallback 실행 규칙 명시

* **명령 충돌 감지**: 동일 세션 내 상충 명령어 발생 시 에러 로그 자동 기록 + 우선순위 대응  
  * ✅ [보완] 충돌 감지 로그 생성 + 강제 종료 우선 규칙 삽입

---

## 2. API 연동 및 확장성

* **자연어 명령 API화**: 주요 명령어(모드 전환, 인지자 호출 등)를 REST API/GraphQL 방식으로 노출  
  * ✅ [보완] `GET /switch_mode?target=designer`, `POST /invoke_agent` 예시 삽입 예정

* **프론트엔드 연동 기준**:  
  * 음성 명령 처리 (Whisper 연동)  
  * 출력 조정 UI (명령 적용 시 시각적 피드백 제공)

* **보안 대응**:  
  * ✅ [보완] API 접근 토큰에 따라 `mode_level` 차등화 (`admin`, `user`, `observer`)

---

## 3. 복수 사용자 대응 설계

* **사용자 인증 구분**: 사용자 단위 ID에 따라 설정된 인지자/모드 세트 분리 운영  
  * ✅ [보완] `user_profile.yaml` 기반 구조 설계 진행

* **권한 레벨 분리**: 운영자 vs 일반 사용자 모드 가용 범위 차등 적용

* **동시 실행 제한**: 병렬 명령어 실행 중 동일 인지자 호출 시 충돌 감지 시스템 필요  
  * ✅ [보완] 인지자 실행 lock 구조 적용 (`mutex-agent-call`)

---

## 4. 버전 관리 및 메타데이터 정책

* **릴리즈 구분 방식**:  
  * `spec-v1.x.x` → 구조 명세용  
  * `exec-v1.x.x` → 실행 명령 기반 버전

* **SHA256 해시 명세 포함**:  
  * ✅ [보완] 모든 문서 버전은 고유 해시 포함하여 무단 변조 방지

* **Fingerprint-ID**:  
  * 구조 설계자 ID + 일자 기반 고정 ID 포함 (예: `minseo_kang::U-Type::v1.1.0`)

---

## 5. 적용 우선순위 제안

1. 예외 처리 체계 (명령 충돌, fallback 시스템)  
2. API 연결 구조 (자연어 명령-시스템 트리거 연동)  
3. 다중 사용자 대응 모듈 (권한 분리 및 세션 분리)  
4. 버전 관리 메타데이터 고정 (hash, ID, 릴리즈 구분)  
5. 프론트 연동 요소 설계 (시각화 및 음성 입력 대응)

---

## 🔐 구조 리스크 요약 및 대응

| 리스크 항목 | 심각도(1~5) | 대응 전략 |
|-------------|-------------|------------|
| 명령 충돌 모드 | 4 | 모드 우선순위 테이블 삽입 및 강제 중지 우선 규칙 |
| 자유 명령 해석 실패 | 3 | fallback 시스템 + 감정 인지자 병행 실행 자동화 |
| API 권한 노출 | 5 | mode_level 기반 인증 + 토큰 분리 설계 |
| 사용자 세션 충돌 | 4 | 인지자 instance 분리 + mutex 실행 제한 |
| 해시 불일치 | 3 | 모든 버전 SHA 자동 생성 + 메타데이터 이중화 |
| 프론트 연동 타이밍 오차 | 2 | 인터페이스 ↔ 시스템 간 동기화 대기 구조 삽입 |

---

## 🔚 문서 목적

본 문서는 U-Type-001의 실사용 확장성을 위해 `spec-v1.1.0` 기준 기술 방향을 고정 제시함.  
향후 구조 명세 및 실행 명령 체계 구분 기반으로 릴리즈될 문서이며,  
구조 고정자 지문, 해시 포함 상태로 메타관리 시스템에 등록될 예정.

---

**📌 SHA256 Hash:**  
`a00e83f3a36943bd2401e6317797687ae324d1e929d27d28d60e4d7f92a4a5e1`

